---
title: 一次特殊的root密码错误经历
date: 2018-03-27 21:25:14
updated: 2018-03-27 21:25:14
tags:
  - Linux
categories: 
  - Linux
---

自从去年寒假剁手买了[搬瓦工VPS][1]之后，寒假中就在上面搭建了自己的博客。今天晚上吃饭回来准备更新一把博客，结果登录的时候提示`Permission denied, please try again.`。我的密码是搬瓦工后台管理面板自己生成的，而且我最近也没有改啊，怎么会突然就不能登录呢？

经过一晚上的排查，最后终于知道自己犯了一个很蠢的错误。欲知详情，请继续阅读。

<!-- more -->

一发现不能登录系统，首先想到的是会不会机器被黑了然后密码被改了，或者本地存储密码的文件被我不小心改了？于是我先上搬瓦工控制面板后台尝试重置密码。结果提示：
```
Error
MAINTENANCE: KiwiVM control panel is temporarily unavailable. Please try again in a few minutes. (3009005)
```

这是啥情况？晕死。难道是搬瓦工的管理后台罢工了？论坛求助各位大佬，貌似也没人遇到过这种情况。没办法只能自己捣鼓了。

这期间我甚至尝试了调用搬瓦工提供的`API`接口重置密码，结果发现可以重置成功，但是还是不能登录上，初步明确了是我的机器的问题，搬瓦工管理面板应该没有罢工。

因为机器上已经装了很多环境了，重新格盘再装的话会很麻烦，所以我暂时还不想重装。试了一下，搬瓦工管理面板上的`basic shell`仍然能进去，但是进行`passwd`的时候，提示我用`interactive shell`来执行这个命令。然鹅，`interactive shell`首先就需要我登录。我不知道root的密码啊亲，这就很尴尬了。

谷歌一下，有网友说是不是`root`用户被禁用了，或者其他原因导致了`root`账户不可登录。具体可以参照[root帐户无法登陆解决办法][2]。一一尝试过后仍然不行。这时看到一篇帖子说可以尝试去掉`root`的密码，将`root`密码置为空，就可以不输入密码登录。抱着死马当活马医的心态，尝试了一下。结果发现，我的`/etc/shadow`里面全是空的，一行数据都没有，这是咋了？？

冷静下来仔细回想了一下，原来中午的时候，清理机器上的文件，因为这个跟某个知名梯子的名称比较像，当时没反应过来，把`/etc/shadow`当做垃圾文件给删了(哭。。。)，甚至，我还把它的备份文件`/etc/shadow-`也给删了，被自己蠢哭了。

还好是自己的机器，不是公司的生产机器，不然该出事故了。所以特地写作此文以示警戒。

---

挖个坑，后面有空来补一下`Linux`系统中存储用户名和密码的`/etc/passwd`和`/etc/shadow`两个文件中内容的具体含义

[ ] [/etc/passwd文件详解][3]
[ ] [/etc/shadow文件详解][4]


[1]: https://bwh1.net/aff.php?aff=29080 "搬瓦工VPS"
[2]: "root 帐户无法登陆解决办法"
[3]: "/etc/passwd文件详解"
[4]: "/etc/shadow文件详解"